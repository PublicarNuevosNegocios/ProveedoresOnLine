@model MarketPlace.Models.Provider.ProviderViewModel
@{
    ViewBag.Title = "Proveedores OnLine - Evaluación de desempeño";
    Layout = MVC.Desktop.Shared.Views._Layout;

    Model.RenderScripts = false;

    string strjsUpdateObject = string.Empty;
    if (Model.RelatedSurvey.SurveyStatus == MarketPlace.Models.General.enumSurveyStatus.Program)
    {
        strjsUpdateObject = (new System.Web.Script.Serialization.JavaScriptSerializer()).
            Serialize(new
            {
                SurveyStatus = (int)Model.RelatedSurvey.SurveyStatus,

                SurveyPublicId = Model.RelatedSurvey.SurveyPublicId,
                ProviderPublicId = Model.RelatedLiteProvider.RelatedProvider.RelatedCompany.CompanyPublicId,

                SurveyConfigId = Model.RelatedSurvey.SurveyConfigId,
                SurveyConfigName = Model.RelatedSurvey.SurveyConfigName,

                SurveyEvaluator = Model.RelatedSurvey.SurveyEvaluator,
                SurveyEvaluatorId = Model.RelatedSurvey.SurveyEvaluatorId,

                SurveyIssueDate = Model.RelatedSurvey.SurveyIssueDate,
                SurveyIssueDateId = Model.RelatedSurvey.SurveyIssueDateId,

                SurveyContract = Model.RelatedSurvey.SurveyContract,
                SurveyContractId = Model.RelatedSurvey.SurveyContractId,

                SurveyStartDate = Model.RelatedSurvey.SurveyStartDate,
                SurveyStartDateId = Model.RelatedSurvey.SurveyStartDateId,

                SurveyEndDate = Model.RelatedSurvey.SurveyEndDate,
                SurveyEndDateId = Model.RelatedSurvey.SurveyEndDateId,

                SurveyComments = Model.RelatedSurvey.SurveyComments,
                SurveyCommentsId = Model.RelatedSurvey.SurveyCommentsId,

                SurveyRelatedProject = Model.RelatedSurvey.SurveyRelatedProject,
                SurveyRelatedProjectId = Model.RelatedSurvey.SurveyRelatedProjectId,
            });

    }

    Tuple<int, int> MandatoryInfo = Model.RelatedSurvey.GetMandatoryAnsweredQuestions();

    MarketPlace.Models.Survey.SurveyProgramModel oSurveyModel = new MarketPlace.Models.Survey.SurveyProgramModel()
    {
        RenderScripts = false,
    };
}
@*ESTE ES EL ENVUELTO COMPLETO DE MENU LATERAL Y CONTENIDO*@
<div class="POMPProviderGreatWrapper">
    @*ESTE ES QUE TRAE EL PARCIAL QUE PINTA EL MENU LATERAL*@
    <div class="POMPProviderSideMenuWrapper">
        @Html.Partial(MVC.Desktop.Shared.Views._P_ProviderMenu, Model)
    </div>

    <div class="POMPProviderDataWrapper">
        <label class="POMPSectionTitles">Detalle de evaluación de desempeño</label>
        <div class="POMPResultsOrder">
            <div class="POMPResultsBasicInfo">
                <!--evaluation basic info-->
                <div class="container-fluid">
                    <div class="POMPEvalTitle">
                        <div class="col-xs-12">
                            <a>
                                @((string.IsNullOrEmpty(Model.RelatedSurvey.SurveyConfigGroup) ? string.Empty : (Model.RelatedSurvey.SurveyConfigGroup + " - ")) + Model.RelatedSurvey.SurveyConfigName)
                            </a>
                        </div>
                        <div class="col-xs-12">
                            <div class="col-xs-4" style="margin-top:0;">
                                <label>Calificación:</label>
                                <div class="rateit" data-rateit-value="@Model.RelatedSurvey.SurveyRating.ToString("0.##").Replace(",", ".")" data-rateit-ispreset="true" data-rateit-readonly="true"></div>
                                <span>(@Model.RelatedSurvey.SurveyRating.ToString("0.##").Replace(",", "."))</span>
                            </div>
                            <div class="col-xs-8" style="margin-top:0;">
                                <div class="col-xs-12">
                                    <div id="loading" class="selProgressBar" style="width:89%; margin-bottom:4px; data-value="@Model.RelatedSurvey.SurveyProgress"></div>
                                    <span>(@MandatoryInfo.Item2/@MandatoryInfo.Item1)</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-12">
                        <div class="col-xs-4">
                            <div class="col-xs-12">
                                <label>Estado:</label>
                            </div>
                            <div class="col-xs-12">
                                <span>@Model.RelatedSurvey.SurveyStatusName</span>
                            </div>
                        </div>
                        <div class="col-xs-8">
                            <div class="col-xs-12">
                                <label>Fecha de programación:</label>
                            </div>
                            <div class="col-xs-12">
                                <span>@Model.RelatedSurvey.SurveyIssueDate</span>
                            </div>
                        </div>
                        <div class="col-xs-12">
                            <div class="POMPEvaluator">
                                <div class="col-xs-12" style="margin:5px 0 5px 0;">
                                    <label>Evaluador:</label>
                                </div>


                                @foreach (string EvaluatorUser in Model.RelatedSurvey.SurveyEvaluatorList)
                                {
                                    <div class="col-xs-4" style="text-decoration:underline; font-size:12px;  height:40px; line-height:40px;">
                                        <a href="@(Url.RouteUrl(MarketPlace.Models.General.Constants.C_Routes_Default,
                                    new
                                    {
                                        controller = MVC.Provider.Name,
                                        action = MVC.Provider.ActionNames.SVSurveyEvaluatorDetail,
                                        ProviderPublicId = Model.RelatedLiteProvider.RelatedProvider.RelatedCompany.CompanyPublicId,
                                        SurveyPublicId = Model.RelatedSurvey.SurveyPublicId,
                                        User = EvaluatorUser
                                    }))">@EvaluatorUser</a>
                                </div>

                                }

                                @*<span>@Model.RelatedSurvey.SurveyEvaluator</span>*@

                            </div>
                        </div>
                        <div class="col-xs-4">
                            <div class="col-xs-12">
                                <label>Ultima actualización:</label>
                            </div>
                            <div class="col-xs-12">
                                <span>@Model.RelatedSurvey.SurveyLastModify</span>
                            </div>
                        </div>
                        <div class="col-xs-4">
                            <div class="col-xs-12">
                                <label>Responsable:</label>
                            </div>
                            <div class="col-xs-12">
                                <span>@Model.RelatedSurvey.SurveyResponsible</span>
                            </div>
                        </div>
                        <div class="col-xs-4">
                            <div class="col-xs-12">
                                <label>Proceso de Selección</label>
                            </div>
                            <div class="col-xs-12">
                                <span>@Model.RelatedSurvey.SurveyRelatedProject</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-12">
                        <div class="row">
                            <div class="col-xs-4 pull-right">
                                <a style="color:#337ab7 !important;" href="@(Url.Action(
                MVC.Provider.ActionNames.SVSurveySearch,
                MVC.Provider.Name,
                   new { ProviderPublicId = Model.RelatedLiteProvider.RelatedProvider.RelatedCompany.CompanyPublicId }))">
                                    Regresar al listado de evaluaciones.
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--templates-->
    <div style="display:none;">

        @Html.Partial(MVC.Desktop.Shared.Views._SV_ProgramSurvey, oSurveyModel)

    </div>

    @{
        Model.RenderScripts = true;
        oSurveyModel.RenderScripts = true;
    }
    @section inlinescripts
{
        @Html.Partial(MVC.Desktop.Shared.Views._P_ProviderMenu, Model)
        @Html.Partial(MVC.Desktop.Shared.Views._SV_ProgramSurvey, oSurveyModel)

        <script type="text/javascript">
            $(document).ready(function () {
                //show generic progress bar
                Survey_SaveObject.ProgressBar_Generic_Show();
            });
        </script>
    }

